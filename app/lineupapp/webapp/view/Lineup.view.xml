<mvc:View
  controllerName="my.apmorrowland.lineupapp.controller.Lineup"
  displayBlock="true"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:core="sap.ui.core"
  xmlns:unified="sap.ui.unified">

  <Page title="Line-up &amp; Planning">
    <headerContent>
      <Toolbar>

        <Label text="Dag" class="sapUiTinyMarginEnd"/>
        <ComboBox
          id="cbDay"
          width="14rem"
          placeholder="Alle dagen"
          showClearIcon="true"
          selectionChange=".onFilterChange"
          items="{ path: '/FestivalDays' }">
          <core:Item key="{ID}" text="{label}"/>
        </ComboBox>

        <ToolbarSeparator/>

        <Label text="Stage" class="sapUiTinyMarginEnd"/>
        <ComboBox
          id="cbStage"
          width="14rem"
          placeholder="Alle stages"
          showClearIcon="true"
          selectionChange=".onFilterChange"
          items="{ path: '/Stages' }">
          <core:Item key="{ID}" text="{name}"/>
        </ComboBox>

        <ToolbarSeparator/>

        <Button
          id="btnSortTime"
          text="Sorteer op starttijd"
          type="Transparent"
          icon="sap-icon://sort"
          press=".onSortStartTime"/>

        <ToolbarSpacer/>

        <Button
          text="Refresh"
          type="Transparent"
          icon="sap-icon://refresh"
          press=".onRefresh"/>
      </Toolbar>
    </headerContent>

    <content>
      <IconTabBar id="itb" expanded="true">
        <items>

          <!-- TAB 1: Overzicht -->
          <IconTabFilter text="Overzicht" key="list" icon="sap-icon://list">
            <VBox class="sapUiMediumMargin">
              <Text text="Filter op dag en stage. Klik op sorteren om starttijd te togglen." />

              <List
                id="perfList"
                class="sapUiSmallMarginTop"
                growing="true"
                growingScrollToLoad="true"
                items="{
                  path: '/Performances',
                  parameters: { $expand: 'artist,stage,festivalDay', $orderby: 'startTime asc' }
                }">

                <items>
                  <ObjectListItem
                    title="{= ${artist/name} + ' â€” ' + ${stage/name} }"
                    intro="{festivalDay/label}"
                    number="{startTime}"
                    numberUnit="start">
                    <attributes>
                      <ObjectAttribute title="End" text="{endTime}"/>
                    </attributes>
                  </ObjectListItem>
                </items>

              </List>
            </VBox>
          </IconTabFilter>

          <!-- TAB 2: Kalender -->
          <IconTabFilter text="Kalender" key="calendar" icon="sap-icon://calendar">
            <VBox class="sapUiMediumMargin">
              <Text text="Kalenderweergave per stage (rij) met performances als afspraken." />

              <PlanningCalendar
                id="pc"
                startDate="{cal>/startDate}"
                rows="{cal>/rows}"
                showDayNamesLine="true"
                showWeekNumbers="true"
                appointmentSelect=".onAppointmentSelect"
                appointmentsVisualization="Filled">

                <rows>
                  <PlanningCalendarRow
                    title="{cal>stageName}"
                    text="{cal>stageCapacity}"
                    appointments="{cal>appointments}">
                    <appointments>
                      <unified:CalendarAppointment
                        title="{cal>title}"
                        text="{cal>text}"
                        startDate="{cal>start}"
                        endDate="{cal>end}"
                        type="{cal>type}"/>
                    </appointments>
                  </PlanningCalendarRow>
                </rows>

              </PlanningCalendar>

            </VBox>
          </IconTabFilter>

        </items>
      </IconTabBar>
    </content>
  </Page>

</mvc:View>
